## Render a tree view of a register
##   $register will be bound to the register
##   $item     will be bound to the corresponding RegisterItem

#if($register.hasResourceValue("rdf:type", "skos:ConceptScheme"))
  #set($rootProp = "skos:topConceptOf")
  #set($narrow="skos:narrower|^skos:broader")
#else
  #set($rootType = $item.getPropertyValue("ui:hierarchyRootType"))
  #set($rootProp = $item.getPropertyValue("ui:hierarchyRootProperty"))
  #set($narrow=$item.getPropertyValue("ui:hierarchyChildProperty").lexicalForm)
#end

#if($rootType) 
  #set($queryPart="?entity a $rootType. ")
#elseif($rootProp)
  #set($queryPart="?entity $rootProp []. ")
#else
  ## can't happen
  #set($queryPart="")
#end

#set($query="SELECT DISTINCT ?item WHERE {<$register.uRI> ^reg:register ?item . ?item version:currentVersion/reg:definition/reg:entity ?entity . $queryPart}")

#parse("hlist-render.vm")